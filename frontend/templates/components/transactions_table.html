{# Tableau des transactions (r√©utilisable pour HTMX) #}
<div id="transactions-table-container">
    <table class="table is-fullwidth is-striped is-hoverable">
        <thead>
            <tr>
                <th>Date</th>
                <th>Description</th>
                <th>Cat√©gorie</th>
                <th>Compte</th>
                <th class="has-text-right">Montant</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% if transactions %}
                {% for tx in transactions %}
                <tr id="transaction-{{ tx.id }}">
                    <td>{{ tx.date.strftime('%d/%m/%Y') }}</td>
                    <td>
                        <strong>{{ tx.description }}</strong>
                        {% if tx.envelope %}
                        <br><small class="has-text-grey">üì¶ {{ tx.envelope.name }}</small>
                        {% endif %}
                    </td>
                    <td>
                        {% if tx.category %}
                        <span class="tag">{{ tx.category.name }}</span>
                        {% endif %}
                    </td>
                    <td>{{ tx.bank_account.name if tx.bank_account else 'Esp√®ces' }}</td>
                    <td class="has-text-right {% if tx.type == 'income' %}has-text-success{% else %}has-text-danger{% endif %}">
                        {{ '+' if tx.type == 'income' else '-' }}{{ "%.2f"|format(tx.amount) }}‚Ç¨
                    </td>
                    <td>
                        <div class="buttons are-small">
                            <button class="button is-info is-light"
                                    hx-get="/api/transactions/{{ tx.id }}/detail"
                                    hx-target="#modal-container"
                                    hx-swap="innerHTML">
                                <span class="icon"><i class="fas fa-eye"></i></span>
                            </button>
                            <button class="button is-warning is-light"
                                    hx-get="/api/transactions/{{ tx.id }}/edit"
                                    hx-target="#modal-container"
                                    hx-swap="innerHTML">
                                <span class="icon"><i class="fas fa-edit"></i></span>
                            </button>
                            <button class="button is-danger is-light"
                                    hx-delete="/api/transactions/{{ tx.id }}"
                                    hx-target="#transactions-table-container"
                                    hx-swap="outerHTML"
                                    hx-confirm="√ätes-vous s√ªr ?">
                                <span class="icon"><i class="fas fa-trash"></i></span>
                            </button>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            {% else %}
            <tr>
                <td colspan="6" class="has-text-centered has-text-grey">
                    <i class="fas fa-inbox"></i> Aucune transaction
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>
